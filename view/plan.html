<!DOCTYPE html>
<html lang="en">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1,shrink-to-fit=no">
    <meta name="theme-color" content="#000000">
    <!--<base href="/">-->
    <base href=".">

    <!-- @todo Next line causes warning in IDE
    <link rel="manifest" href="./lib/manifest.json"> -->

    <link rel="shortcut icon" href="images/favicon.ico">
    <title>Carbon Reduction Helper - Plan</title>

    <link href="lib/2.67123b20.chunk.css" rel="stylesheet">
    <link href="lib/main.a391ff7c.chunk.css" rel="stylesheet">

    <script src="view.js"></script>
    <script src="../model.js"></script>
    <script src="../controller.js"></script>
    <script src="../persistence.js"></script>

    <script src="lib/common.js"></script>

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-173546127-1"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'UA-173546127-1');
    </script>

    <style>
        .slideSource_fade {
            transition: background-color 0.2s;
            background-color: blue;
        }

    </style>
</head>

<!-------------------------------------------------------------->

<body data-gr-c-s-loaded="true">

<noscript>You need to enable JavaScript to run this app.</noscript>

<!--suppress ES6ConvertVarToLetConst -->
<script>
    var volatilityConfirmed=false;
    var incLowImpactSteps = urlParams.get('incLowImpactSteps')

</script>
<script>
    function pulse(element, withStyle){
        element.classList.toggle(withStyle);
        setTimeout(fadeIn, 200, element)
    }

    function fadeIn(element){
        element.classList.toggle(element.classList[0])
    }
</script>

<!-------------------------------------------------------------->

<div id="root">
    <div>
        <table style="margin-left:20px;">
            <tr>
                <td valign="top" width="250">
			<br>
			<br>
			<br>
			<br>
			<br>
			<br>
			<br>
                    <div id="resultsSummary">Calculating ...</div>
                    <hr>
                    Search by text contents
                    &nbsp;&nbsp;&nbsp;<input
                        type="text"
                        id="searchField"
                        value="e.g. electric"
                        onchange="alert('Not implemented in this proof-of-concept.  Please use the browser\'s find facility')"
                ><hr>

                    Filter by category<br>
                    &nbsp;&nbsp;&nbsp;<input type="checkbox" checked disabled>Food (save upto ??%) <br>
                    &nbsp;&nbsp;&nbsp;<input type="checkbox" checked disabled>Technology (save upto ??%) <br>
                    &nbsp;&nbsp;&nbsp;<input type="checkbox" checked disabled>Travel (save upto ??%) <br>
                    <br>
                    Filter by status<br>
                    &nbsp;&nbsp;&nbsp;<input type="checkbox" checked disabled>Maybe<br>
                    &nbsp;&nbsp;&nbsp;<input type="checkbox" checked disabled>Plan to<br>
                    &nbsp;&nbsp;&nbsp;<input type="checkbox" checked disabled>Done <br>
                    &nbsp;&nbsp;&nbsp;<input type="checkbox" checked disabled>N/A<br>
                    &nbsp;&nbsp;&nbsp;<input type="checkbox" checked disabled>Never<br>
                    <br>
                    Include information on<br>
                    &nbsp;&nbsp;&nbsp;<input type="checkbox" checked  disabled onchange="alert('Disabling is not implemented in this proof-of-concept'); this.value='All'">Cost effectiveness<br>
                    <br>
                    Filter by impact on person<br>
                    &nbsp;&nbsp;&nbsp;<select >
                    <option>Any </option>
                    <option disabled>Medium or less</option>
                    <option disabled>Low or less</option>
                </select> disruption<br>
                    <br>
                    &nbsp;&nbsp;&nbsp;<select >
                    <option>Any </option>
                    <option disabled>Medium or less</option>
                    <option disabled>Low or less</option>
                </select> cost
                    <br>
                    <br>
                    Filter by carbon reduction<br>
                    &nbsp;&nbsp;&nbsp;<input id="showStepsBelow5perc" type="checkbox" onchange="refresh_steps()"> Include steps with a reduction of less than 5%<br>
                </td><td>

        <header>
            <nav class="navbar-expand-sm navbar-toggleable-sm ng-white border-bottom box-shadow mb-3 navbar navbar-light">
                <div class="container">
                    <a disabled="" class="navbar-brand disabled" href="../index.html">Carbon Reduction Helper (proof-of-concept)</a>
                    <button aria-label="Toggle navigation" type="button" class="mr-2 navbar-toggler">
                        <span class="navbar-toggler-icon"></span>
                    </button>
                    <div class="d-sm-inline-flex flex-sm-row-reverse collapse navbar-collapse">
                        <ul class="navbar-nav flex-grow">
                            <li class="nav-item">
                                <a class="text-dark nav-link" href="#" onclick="gotoMenu('dashboard.html');return false">Dashboard</a>
                            </li>
                            <li class="nav-item">
                                <a class="text-dark nav-link" disabled="" href="#" onclick="gotoMenu('plan.html');return false">[Plan]</a>
                            </li>
                            <li class="nav-item">
                                <a class="text-dark nav-link" href="#" onclick="gotoMenu('familiarise.html');return false">Familiarise</a>
                            </li>
                            <li class="nav-item">
                                <a class="text-dark nav-link"  href="#" onclick="gotoMenu('complete.html');return false">Complete</a>
                            </li>

                            <li class="nav-item">
                                <a class="text-dark nav-link" href="#" onclick="gotoMenu('help.html');return false">Help</a>
                            </li>
                        </ul>
                    </div>
                </div> <!-- container -->
            </nav>
        </header>
        <div class="container-xl">
            <div class="row">
                <table bgcolor="yellow" width="65%">
                    <tr>
                        <td>
                            Tips:
                            <small>
                                <ul>
                                    <li>scroll down the list of steps to find the first one you maybe happy looking at</li>
                                    <li>click on its associated status and select your preference</li>
                                    <li>if you want more information before deciding, click on the "More info ..." in the description</li>
                                </ul>
                            </small>
                        </td>
                    </tr>
                </table> <!-- Tips area -->



                <div class="col-md-8"> <!-- tips and list of steps -->
                                <table class="table table-striped" aria-labelledby="tableLabel">
                                    <thead>
                                    <tr>
                                        <th style="vertical-align:top">Step</th>
                                        <th>Carbon Reduction<img src="images/sort_down.png"><br><small>(c.f. average<br>UK person)</small></th>
                                        <th style="vertical-align:top">
                                            <a
                                                    href="plan.html"
                                                    onClick='alert("Sorting on this column is not implemented in this proof-of-concept")'>Cost effect-iveness
                                            </a>
                                        </th>
                                        <th style="vertical-align:top">
                                            <a href="plan.html"
                                               onClick='alert("Sorting on this column is not implemented in this proof-of-concept")'>Status
                                            </a>
                                        </th>
                                    </tr>
                                    </thead>
                                    <tr>
                                    <tr><td></td></tr>
                                    <tr>
                                        <td>Replace an old gas boiler with an air source heat pump<br>
                                            <a href="familiarise.html?step=10">More ...</a></td>
                                        <td>23%</td>
                                        <td style='display:none'>**---</td>
                                        <td>??<br>%/Â£/yr</td>
                                        <td>
                                            <select id="step10_stateSelector" class="form-control" onChange="handle_stepStateChange(10, this.value)" style="width:150px">
                                                <option value=""></option>
                                                <option value="maybe">Maybe</option>
                                                <option value="aspiring">Plan to</option>
                                                <option value="done">Completed</option>
                                                <option value="na">Not applicable</option>
                                                <option value="never">Never</option>
                                            </select>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>Replace an old gas boiler with a ground source heat pump<br>
                                            <a href="familiarise.html?step=20">More ...</a></td>
                                        <td>23%</td>
                                        <td style='display:none'>**---</td>
                                        <td>??<br>%/Â£/yr</td>
                                        <td>
                                            <select id="step20_stateSelector" class="form-control" onChange="handle_stepStateChange(20, this.value)" style="width:150px">
                                                <option value=""></option>
                                                <option value="maybe">Maybe</option>
                                                <option value="aspiring">Plan to</option>
                                                <option value="done">Completed</option>
                                                <option value="na">Not applicable</option>
                                                <option value="never">Never</option>
                                            </select>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>Replace 5 beef (herd) portions/week with poultry<br>
                                            <a href="familiarise.html?step=30">More ...</a>
                                        </td>
                                        <td>20%</td>
                                        <td style='display:none'>**---</td>
                                        <td>Max<br>%/Â£/yr</td>
                                        <td>
                                            <select id="step30_stateSelector" class="form-control" onChange="handle_stepStateChange(30, this.value)">
                                                <option value=""></option>
                                                <option value="maybe">Maybe</option>
                                                <option value="aspiring">Plan to</option>
                                                <option value="done">Completed</option>
                                                <option value="na">Not applicable</option>
                                                <option value="never">Never</option>
                                            </select>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>Replace a petrol car with an electric car<br>
                                            <a href="familiarise.html?step=40">More ...</a>
                                        </td>
                                        <td>17%</td>
                                        <td>??<br>%/Â£/yr</td>
                                        <td  style="display:none">***--</td>
                                        <td>
                                            <select id="step40_stateSelector" class="form-control" onChange="handle_stepStateChange(40, this.value)">
                                                <option value=""></option>
                                                <option value="maybe">Maybe</option>
                                                <option value="aspiring">Plan to</option>
                                                <option value="done">Completed</option>
                                                <option value="na">Not applicable</option>
                                                <option value="never">Never</option>
                                            </select>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>Increase loft insulation from ??cm to ??cm in a gas heated house with an old boiler<br>
                                            <a href="familiarise.html?step=50">More ...</a>
                                        </td>
                                        <td>17%</td>
                                        <td>??<br>%/Â£/yr</td>
                                        <td  style="display:none">***--</td>
                                        <td>
                                            <select id="step50_stateSelector" class="form-control" onChange="handle_stepStateChange(50, this.value)">
                                                <option value=""></option>
                                                <option value="maybe">Maybe</option>
                                                <option value="aspiring">Plan to</option>
                                                <option value="done">Completed</option>
                                                <option value="na">Not applicable</option>
                                                <option value="never">Never</option>
                                            </select>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>Switch from an old conventional gas boiler to a high efficiency condensing gas boiler<br>
                                            <a href="familiarise.html?step=60">More ..."</a></td>
                                        <td>9%</td>
                                        <td>??<br>%/Â£/yr</td>
                                        <td  style="display:none">**---</td>
                                        <td>
                                            <select id="step60_stateSelector" class="form-control" onChange="handle_stepStateChange(60, this.value)">
                                                <option value=""></option>
                                                <option value="maybe">Maybe</option>
                                                <option value="aspiring">Plan to</option>
                                                <option value="done">Completed</option>
                                                <option value="na">Not applicable</option>
                                                <option value="never">Never</option>
                                            </select>
                                        </td>
                                    </tr>

                                    <tr>
                                        <td>Commute by walking rather than driving a petrol car</td>
                                        <td>8%</td>
                                        <td>??<br>%/Â£/yr</td>
                                        <td  style="display:none">*----</td>
                                        <td>
                                            <select id="step70_stateSelector" class="form-control"  onChange="handle_stepStateChange(70, this.value)">
                                                <option value=""></option>
                                                <option value="maybe">Maybe</option>
                                                <option value="aspiring">Plan to</option>
                                                <option value="done">Completed</option>
                                                <option value="na">Not applicable</option>
                                                <option value="never">Never</option>
                                            </select>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>Replace 2 beef (herd) portions/week with poultry</td>
                                        <td>8%</td>
                                        <td>Max</td>
                                        <td  style="display:none">**---</td>
                                        <td>
                                            <select id="step80_stateSelector" class="form-control"  onChange="handle_stepStateChange(80, this.value)">
                                                <option value=""></option>
                                                <option value="maybe">Maybe</option>
                                                <option value="aspiring">Plan to</option>
                                                <option value="done">Completed</option>
                                                <option value="na">Not applicable</option>
                                                <option value="never">Never</option>
                                            </select>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>Reduce home thermostat by 2 deg C in a house with an old gas central heating</td>
                                        <td>7%</td>
                                        <td style='display:none'>**---</td>
                                        <td>??<br>%/Â£/yr</td>
                                        <td>
                                            <select id="step90_stateSelector" class="form-control" onChange="handle_stepStateChange(90, this.value)">
                                                <option value=""></option>
                                                <option value="maybe">Maybe</option>
                                                <option value="aspiring">Plan to</option>
                                                <option value="done">Completed</option>
                                                <option value="na">Not applicable</option>
                                                <option value="never">Never</option>
                                            </select>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>Work 1 day/week at home rather than commuting via a petrol car</td>
                                        <td>5%</td>
                                        <td>??<br>%/Â£/yr</td>
                                        <td  style="display:none">***--</td>
                                        <td>
                                            <select id="step100_stateSelector" class="form-control"  onChange="handle_stepStateChange(100, this.value)">
                                                <option value=""></option>
                                                <option value="maybe">Maybe</option>
                                                <option value="aspiring">Plan to</option>
                                                <option value="done">Completed</option>
                                                <option value="na">Not applicable</option>
                                                <option value="never">Never</option>
                                            </select>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>Drive rather than fly to holiday location 1,000 miles away</td>
                                        <td>0%</td>
                                        <td>??<br>%/Â£/yr</td>
                                        <td  style="display:none">***--</td>
                                        <td>
                                            <select id="step110_stateSelector" class="form-control"  onChange="handle_stepStateChange(110, this.value)">
                                                <option value=""></option>
                                                <option value="maybe">Maybe</option>
                                                <option value="aspiring">Plan to</option>
                                                <option value="done">Completed</option>
                                                <option value="na">Not applicable</option>
                                                <option value="never">Never</option>
                                            </select>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>One staycation per year rather than a 1,000 mile flight.</td>
                                        <td>5%</td>
                                        <td>??<br>%/Â£/yr</td>
                                        <td  style="display:none">***--</td>
                                        <td>
                                            <select id="step120_stateSelector" class="form-control"  onChange="handle_stepStateChange(120, this.value)">
                                                <option value=""></option>
                                                <option value="maybe">Maybe</option>
                                                <option value="aspiring">Plan to</option>
                                                <option value="done">Completed</option>
                                                <option value="na">Not applicable</option>
                                                <option value="never">Never</option>
                                            </select>
                                        </td>
                                    </tr>
                                    <tr class="below5perc">
                                        <td>Share a petrol car to work</td>
                                        <td>4%</td>
                                        <td>??<br>%/Â£/yr</td>
                                        <td  style="display:none">**---</td>
                                        <td>
                                            <select id="step130_stateSelector" class="form-control"  onChange="handle_stepStateChange(130, this.value)">
                                                <option value=""></option>
                                                <option value="maybe">Maybe</option>
                                                <option value="aspiring">Plan to</option>
                                                <option value="done">Completed</option>
                                                <option value="na">Not applicable</option>
                                                <option value="never">Never</option>
                                            </select>
                                        </td>
                                    </tr>
                                    <tr class="below5perc">
                                        <td>Install solar PV panels</td>
                                        <td>3%</td>
                                        <td>??<br>%/Â£/yr</td>
                                        <td  style="display:none">***--</td>
                                        <td>
                                            <select id="step140_stateSelector" class="form-control"  onChange="handle_stepStateChange(140, this.value)">
                                                <option value=""></option>
                                                <option value="maybe">Maybe</option>
                                                <option value="aspiring">Plan to</option>
                                                <option value="done">Completed</option>
                                                <option value="na">Not applicable</option>
                                                <option value="never">Never</option>
                                            </select>
                                        </td>
                                    </tr>
                                    <!--
                                    <tr class="below5perc">
                                        <td>Replace 8 pints/week with soymilk
                                        </td>
                                        <td>2.7%</td>
                                        <td>??<br>%/Â£/yr</td>
                                        <td  style="display:none">***--</td>
                                        <td>
                                            <select id="step140_stateSelector" class="form-control"  onChange="handle_stepStateChange(140, this.value)">
                                                <option value=""></option>
                                                <option value="maybe">Maybe</option>
                                                <option value="aspiring">Plan to</option>
                                                <option value="done">Completed</option>
                                                <option value="na">Not applicable</option>
                                                <option value="never">Never</option>
                                            </select>
                                        </td>
                                    </tr>
                                    -->
                                    <tr class="below5perc">
                                        <td>Switch to a car with 10% better mpg</td>
                                        <td>2%</td>
                                        <td>??<br>%/Â£/yr</td>
                                        <td  style="display:none">xx**---</td>
                                        <td>
                                            <select id="step150_stateSelector" class="form-control"  onChange="handle_stepStateChange(150, this.value)">
                                                <option value=""></option>
                                                <option value="maybe">Maybe</option>
                                                <option value="aspiring">Plan to</option>
                                                <option value="done">Completed</option>
                                                <option value="na">Not applicable</option>
                                                <option value="never">Never</option>
                                            </select>
                                        </td>
                                    </tr>
                                    <tr class="below5perc">
                                        <td>Switch to commuting by bus rather than a petrol car</td>
                                        <td>2%</td>
                                        <td>??<br>%/Â£/yr</td>
                                        <td  style="display:none">*----</td>
                                        <td>
                                            <select id="step160_stateSelector" class="form-control"  onChange="handle_stepStateChange(160, this.value)">
                                                <option value=""></option>
                                                <option value="maybe">Maybe</option>
                                                <option value="aspiring">Plan to</option>
                                                <option value="done">Completed</option>
                                                <option value="na">Not applicable</option>
                                                <option value="never">Never</option>
                                            </select>
                                        </td>
                                    </tr>
                                    <tr class="below5perc">
                                        <td>Use a train rather than drive on some long trips</td>
                                        <td>1.6%</td>
                                        <td>??<br>%/Â£/yr</td>
                                        <td  style="display:none">*----</td>
                                        <td>
                                            <select id="step170_stateSelector" class="form-control"  onChange="handle_stepStateChange(170, this.value)">
                                                <option value=""></option>
                                                <option value="maybe">Maybe</option>
                                                <option value="aspiring">Plan to</option>
                                                <option value="done">Completed</option>
                                                <option value="na">Not applicable</option>
                                                <option value="never">Never</option>
                                            </select>
                                        </td>
                                    </tr>
                                    <tr class="below5perc">
                                        <td>Install a solar immersion heater diverter feeding a electric hot water tank</td>
                                        <td>1.0%</td>
                                        <td>??<br>%/Â£/yr</td>
                                        <td  style="display:none">**---</td>
                                        <td>
                                            <select id="step180_stateSelector" class="form-control" onChange="handle_stepStateChange(180, this.value)">
                                                <option value=""></option>
                                                <option value="maybe">Maybe</option>
                                                <option value="aspiring">Plan to</option>
                                                <option value="done">Completed</option>
                                                <option value="na">Not applicable</option>
                                                <option value="never">Never</option>
                                            </select>
                                        </td>
                                    </tr>
                                    <tr class="below5perc">
                                        <td>Install solar thermal panels with an electric powered hot water system</td>
                                        <td>1.0%</td>
                                        <td>??<br>%/Â£/yr</td>
                                        <td  style="display:none">**---</td>
                                        <td>
                                            <select id="step190_stateSelector" class="form-control" onChange="handle_stepStateChange(190, this.value)">
                                                <option value=""></option>
                                                <option value="maybe">Maybe</option>
                                                <option value="aspiring">Plan to</option>
                                                <option value="done">Completed</option>
                                                <option value="na">Not applicable</option>
                                                <option value="never">Never</option>
                                            </select>
                                        </td>
                                    </tr>
                                    <tr class="below5perc">
                                        <td>Fill a dishwasher rather than using a half load</td>
                                        <td>0.9%</td>
                                        <td>??<br>%/Â£/yr</td>
                                        <td  style="display:none">**---</td>
                                        <td>
                                            <select id="step200_stateSelector" class="form-control"  onChange="handle_stepStateChange(200, this.value)">
                                                <option value=""></option>
                                                <option value="maybe">Maybe</option>
                                                <option value="aspiring">Plan to</option>
                                                <option value="done">Completed</option>
                                                <option value="na">Not applicable</option>
                                                <option value="never">Never</option>
                                            </select>
                                        </td>
                                    </tr>
                                    <tr class="below5perc">
                                        <td>Reduce your standby power by 50w</td>
                                        <td>0.8%</td>
                                        <td>??<br>%/Â£/yr</td>
                                        <td  style="display:none">**---</td>
                                        <td>
                                            <select id="step210_stateSelector" class="form-control"  onChange="handle_stepStateChange(210, this.value)">
                                                <option value=""></option>
                                                <option value="maybe">Maybe</option>
                                                <option value="aspiring">Plan to</option>
                                                <option value="done">Completed</option>
                                                <option value="na">Not applicable</option>
                                                <option value="never">Never</option>
                                            </select>
                                        </td>
                                    </tr>
                                    <tr class="below5perc">
                                        <td>Replace vented or condensing tumble dryer with heat pump model</td>
                                        <td>0.7%</td>
                                        <td>??<br>%/Â£/yr</td>
                                        <td  style="display:none">**---</td>
                                        <td>
                                            <select id="step220_stateSelector" class="form-control" onChange="handle_stepStateChange(220, this.value)">
                                                <option value=""></option>
                                                <option value="maybe">Maybe</option>
                                                <option value="aspiring">Plan to</option>
                                                <option value="done">Completed</option>
                                                <option value="na">Not applicable</option>
                                                <option value="never">Never</option>
                                            </select>
                                        </td>
                                    </tr>
                                    <tr class="below5perc">
                                        <td>Switch to a start-stop car with same MPG</td>
                                        <td>0.6%</td>
                                        <td>??<br>%/Â£/yr</td>
                                        <td  style="display:none">*----</td>
                                        <td>
                                            <select id="step230_stateSelector" class="form-control"  onChange="handle_stepStateChange(230, this.value)">
                                                <option value=""></option>
                                                <option value="maybe">Maybe</option>
                                                <option value="aspiring">Plan to</option>
                                                <option value="done">Completed</option>
                                                <option value="na">Not applicable</option>
                                                <option value="never">Never</option>
                                            </select>
                                        </td>
                                    </tr>
                                    <tr class="below5perc">
                                        <td>Reduce maximum speed on motorway from 70 to 65 mph</td>
                                        <td>0.6%</td>
                                        <td>Max<br>%/Â£/yr</td>
                                        <td  style="display:none">**---</td>
                                        <td>
                                            <select id="step240_stateSelector" class="form-control"  onChange="handle_stepStateChange(240, this.value)">
                                                <option value=""></option>
                                                <option value="maybe">Maybe</option>
                                                <option value="aspiring">Plan to</option>
                                                <option value="done">Completed</option>
                                                <option value="na">Not applicable</option>
                                                <option value="never">Never</option>
                                            </select>
                                        </td>
                                    </tr>

                                    <tr class="below5perc">
                                        <td>Convert 5 x 60w incandescent light bulbs to LED</td>
                                        <td>0.6%</td>
                                        <td>Max<br>%/Â£/yr</td>
                                        <td  style="display:none">**---</td>
                                        <td>
                                            <select id="step250_stateSelector" class="form-control"  onChange="handle_stepStateChange(250, this.value)">
                                                <option value=""></option>
                                                <option value="maybe">Maybe</option>
                                                <option value="aspiring">Plan to</option>
                                                <option value="done">Completed</option>
                                                <option value="na">Not applicable</option>
                                                <option value="never">Never</option>
                                            </select>
                                        </td>
                                    </tr>
                                    <tr class="below5perc">
                                        <td>Dry clothes on washing line rather than tumble dryer</td>
                                        <td>0.2%</td>
                                        <td>Max<br>%/Â£/yr</td>
                                        <td  style="display:none">**---</td>
                                        <td>
                                            <select id="step260_stateSelector" class="form-control"  onChange="handle_stepStateChange(260, this.value)">
                                                <option value=""></option>
                                                <option value="maybe">Maybe</option>
                                                <option value="aspiring">Plan to</option>
                                                <option value="done">Completed</option>
                                                <option value="na">Not applicable</option>
                                                <option value="never">Never</option>
                                            </select>
                                        </td>
                                    </tr>
                                </table> <!-- table-striped -->
                            </div> <!-- cold-md-8 -->
                <div class="col-md-4"> <!-- Cards container -->
                    <div class="sticky-top pt-2">
                        <!-- Comparison of emissions -->
                        <div class="card">
                            <div class="card-header">
                                <h4>Your carbon reduction</h4>
                                <small>(compared to an average UK adult)</small>
                            </div> <!-- Card-header -->
                            <div class="card-body">
                                <b>Planned :</b> <b id="savedPlanned">Calculating ...</b><br>
                                <b>Completed :</b> <b id="savedDone">Calculating ...</b>
                                <div id="feedback" width="100%"></div>
                            </div> <!-- Car 2 - body -->
                        </div> <!-- Card 2 -->
                    </div> <!-- Sticky-top pt-2 -->
                </div> <!-- col-md-4 -->

            </div> <!-- row -->


            </td>
            </tr>
            </table>

        </div> <!-- container-xl -->
    </div> <!-- Anonymous -->
</div> <!-- Root -->

<!-------------------------------------------------------------->

<script>
    handle_stepStateChange = function(stepId, stateId) {
        if (!volatilityConfirmed) {
            alert('Warning: Step selections are not be saved in this proof-of-concept or updated on the dashboard.');
            volatilityConfirmed = true;
        }

//        controller_handle_stepStateChange(stepId, stateId); //@todo Enable set change when available
        refresh_totals();
    }

    setStepState = function(stepId, stateId) {
        document.getElementById("step" + stepId + "_stateSelector").value = stateId
    }

    refresh_totals = function(){
        //*** Update done values ***
        let savedDonePerc = Math.round(getCarbonSavingsBySelectorValue("done"))
        let savedDoneNewPercText = savedDonePerc + "%"

        let savedDonePercId = document.getElementById("savedDone")
        if(savedDoneNewPercText !== savedDonePercId.innerText){
            savedDonePercId.innerText = savedDoneNewPercText
            pulse(savedDonePercId, "slideSource_fade")
        }

        //*** Update planned values ***
        let savedPlannedPerc = Math.round(getCarbonSavingsBySelectorValue("aspiring"))
        let savedPlannedNewPercText = savedPlannedPerc + "%"

        let savedPlannedPercId = document.getElementById("savedPlanned")
        if(savedPlannedNewPercText !== savedPlannedPercId.innerText){
            savedPlannedPercId.innerText = savedPlannedNewPercText
            pulse(savedPlannedPercId, 'slideSource_fade')
        }

        //*** Update feedback ***
        let savedDoneThresholdPerc = 20;

        let feedbackId = document.getElementById("feedback");
        if(savedDonePercId > savedDoneThresholdPerc) {
            feedbackId.innerText = "Well done you have achieved more than 20% savings.<br>Keep up the good work!";
        }else{
            feedbackId.innerText = ""
        }
    }

    getCarbonSavingsBySelectorValue=function(selectorValue) {
        let stepSelectors = document.getElementsByClassName("form-control");
        let i;
        let saved = 0

        console.log("Emissions for '" + selectorValue + "': Calculating ...")
        for (i = 0; i < stepSelectors.length; i++) {   // Each selector
            let stepSelector = stepSelectors[i];
            let stepSelectorValue = stepSelector.value
            if (stepSelectorValue === selectorValue) {
                let emissionsString = stepSelector.parentNode.parentNode.children[1].innerText
                // Get first number in string ignoring "," separator
                let emissionsValue = parseFloat(emissionsString.replace(",", ""))
                saved = saved + emissionsValue;
            }
        }
        console.log("Emissions for '" + selectorValue + "': " + saved + "%")
        return saved
    }

    refresh_steps = function(){
        let showStepsBelow5percId = document.getElementById('showStepsBelow5perc')
        let stepsBelow5perc = document.getElementsByClassName('below5perc');

        if(incLowImpactSteps!=null){
            incLowImpactSteps = null
            showStepsBelow5percId.checked = true
        }

        if(showStepsBelow5percId.checked) {
            Array.prototype.filter.call(
                stepsBelow5perc,
                function(e){e.style = "";}
            );
			document.getElementById('resultsSummary').innerHTML = "26 out of 26 steps"
        }else{
            Array.prototype.filter.call(
                stepsBelow5perc,
                function(e){e.style = "display:none";}
            );
			document.getElementById('resultsSummary').innerHTML = "12 out of 26 steps"
        }
    }

    refresh_totals();
    refresh_steps()

    </script>

</body>
</html>